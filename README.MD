## Проект: Определение площадей включений металлов (CV)

Интерактивное приложение на базе PySide6 и OpenCV для поиска и измерения площадей включений/дефектов в изображениях металлических образцов. Поддерживает работу с файловыми изображениями и, при наличии совместимого GenICam оборудования, с камерой через библиотеку `harvesters`.

### Ключевые возможности
- Загрузка изображений (`.bmp`, `.png`, др.) и предварительный просмотр.
- Базовая обработка на OpenCV: подготовка изображения, бинаризация/сегментация, поиск контуров.
- Расчёт площади найденных включений в пикселях и относительных величинах (настройка порогов).
- Встроенный GUI на `PySide6` с кнопками, слайдерами и диалогами выбора файлов.
- Интеграция с `pytesseract` для OCR на изображениях при необходимости разметки/подписи.
- Опционально: подключение камеры через `harvesters`/GenICam (если установлен драйвер/GenTL Producer, в стадии тестирования).

## Архитектура (высокоуровнево)
- `src/app.py`: основное приложение и окна, инициализация GUI, обработка событий, запуск потоков камеры/обработки.
- `src/ui.py`: автогенерированный код интерфейса (`design/design.ui`).
- `src/ObjectClasses.py`: потоки/классы обработки, интеграция с Harvester/GenICam.
- `src/utils.py`: адаптеры между OpenCV и Qt (`OpenCVToQtAdapter`), вспомогательные функции, OCR (`pytesseract`).
- `src/mock.py`: заглушки/моки потоков камеры для тестирования без оборудования.

## Требования
- Windows 10/11 или современный Linux (Ubuntu 22.04+). Тестировалось на Windows 11, Ubuntu 25.04.
- Python 3.10+ (рекомендуется 3.10–3.12).
- Системная установка Tesseract OCR.
  - Windows: установщик с релизов Tesseract или пакет `choco install tesseract`.
  - Linux: пакет `sudo apt install tesseract-ocr`.
- Для работы с камерой: установленный GenICam GenTL Producer и драйверы производителя.

## Установка
1) Клонируйте репозиторий и перейдите в каталог проекта:
```bash
git clone <your-repo-url>
cd CvProject
```

2) Создайте и активируйте виртуальное окружение:
```bash
python -m venv .venv
# Windows PowerShell
.\.venv\Scripts\Activate.ps1
# Linux/macOS
source .venv/bin/activate
```

3) Установите зависимости:
```bash
pip install -r requirements.txt
```

4) Установите Tesseract OCR и пропишите путь в переменных окружения:
- Windows (пример): `C:\\Program Files\\Tesseract-OCR\\tesseract.exe`
  - Создайте/обновите переменную окружения `TESSERACT_CMD` со значением абсолютного пути к `tesseract.exe`.
  - Перезапустите терминал/IDE, чтобы переменные применились.
- Linux: как правило, путь будет `/usr/bin/tesseract`; дополнительно ничего прописывать не нужно.

5) (Опционально) Установка под камеру GenICam (поддержка в стадии тестирования):
 - UNDER CONSTRUCTION

## Запуск приложения
Запустите GUI из корня репозитория одной из команд:
```bash
python -m src.app
# или явно по файлу
python src/app.py
```

На Windows также доступен скрипт сборки:
```bash
build.bat
```
и для Linux:
```bash
bash build.sh
```

## Использование
1) Откройте приложение.
2) Загрузите изображение образца металла через меню File -> Open.
3) Настройте параметры пороговой обработки/фильтрации в интерфейсе (слайдеры/поля). Это влияет на сегментацию включений.
4) Запустите анализ. Приложение выполнит бинаризацию, найдёт контуры и посчитает площади включений. В интерфейсе будут показаны результаты и визуализация маски/контуров.
5) (Опционально) Подключите камеру и выберите устройство в диалоге, чтобы выполнять анализ потока в реальном времени.

Примерные изображения для теста находятся в каталоге `imgs/`.

## Конфигурация
- `TESSERACT_CMD`: абсолютный путь к исполняемому файлу Tesseract (Windows).
- Параметры сегментации настраиваются из GUI; значения сохраняются на время сессии.
- Для камер: UNDER_CONSTRUCTION

